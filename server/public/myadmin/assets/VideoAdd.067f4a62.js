import{resolveComponent as i,openBlock as m,createElementBlock as u,createElementVNode as l,createVNode as o,withCtx as t,normalizeStyle as C,pushScopeId as y,popScopeId as V,createTextVNode as v}from"https://esm.sh/vue@3.0.5";import{_ as A}from"./index.10c0c1b8.js";import"https://cdn.jsdelivr.net/npm/ant-design-vue@2.2.0-beta.6/lib/grid/style/index.css";import"https://esm.sh/axios@0.21.1";import"https://esm.sh/vuex@4.0.2";import"https://esm.sh/dayjs@1.10.5";import"https://esm.sh/dayjs@1.10.5/plugin/localeData.js";import"https://esm.sh/dayjs@1.10.5/plugin/customParseFormat.js";import"https://esm.sh/dayjs@1.10.5/plugin/advancedFormat.js";import"https://esm.sh/dayjs@1.10.5/plugin/weekOfYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/weekYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/dayOfYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/isSameOrAfter.js";import"https://esm.sh/dayjs@1.10.5/plugin/isSameOrBefore.js";const U={name:"VideoAdd",data(){return{form:{title:"",video:"",videoCover:""},imageUrl:""}},methods:{async submit(){let{data:e}=await this.$axios({method:"POST",url:"/adminServer/video/add",data:this.form});if(e.code)return this.$message.error(e.msg);await this.$router.push("/Video")},fileChange(e,a){if(e.status==="ready")if(/(.*)\.(mp4|rmvb|avi|ts|flv|mov|3gb|m3u8)$/.test(e.name)){if(this.form.title)return;this.form.title=RegExp.$1}else this.$message.error("\u53EA\u80FD\u4E0A\u4F20.mp4 .avi .flv .rmvb .mov .m3u8 \u6216.3gb\u683C\u5F0F\u7684\u6587\u4EF6"),a.pop()},submitVideo(){this.$refs.videoForm.submit()},beforeRemove(){this.form.title=""},video_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20\u89C6\u9891\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.video=e.url,this.imageUrl?this.$refs.imgForm.submit():this.submit()},videoCoverChange(e,a){if(e.status!=="ready")return;const n=/^image\/(jpeg|png)$/.test(e.raw.type),c=e.raw.size/1024/1024<2;n||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u53EA\u80FD\u662F JPG/PNG \u683C\u5F0F!"),c||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),n&&c?this.imageUrl=URL.createObjectURL(e.raw):(this.imageUrl="",a.pop())},videoCover_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20\u5C01\u9762\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.videoCover=e.url,this.submit()}}},$=e=>(y("data-v-313ba785"),e=e(),V(),e),k={class:"videoAdd"},S={class:"videoPhoto"},P={class:"el-icon-upload"},R=$(()=>l("div",{class:"el-upload__text"},[v("\u5C06\u89C6\u9891\u683C\u5F0F\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),l("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),I={key:1,class:"el-icon-plus avatar-uploader-icon"},L=v("\u786E\u8BA4\u4E0A\u4F20");function z(e,a,n,c,d,r){const h=i("el-input"),s=i("el-form-item"),f=i("upload-filled"),p=i("el-icon"),_=i("el-upload"),g=i("Plus"),b=i("el-button"),x=i("el-form");return m(),u("div",k,[l("div",S,[o(x,{model:d.form},{default:t(()=>[o(s,{label:"\u6807\u9898\uFF1A","label-width":"150px"},{default:t(()=>[o(h,{style:{height:"50px",width:"500px"},modelValue:d.form.title,"onUpdate:modelValue":a[0]||(a[0]=w=>d.form.title=w),placeholder:"\u53EF\u901A\u8FC7\u4E0A\u4F20\u89C6\u9891\u6587\u4EF6\u81EA\u52A8\u83B7\u53D6\u6587\u4EF6\u540D"},null,8,["modelValue"])]),_:1}),o(s,{label:"\u89C6\u9891\u4E0A\u4F20\uFF1A","label-width":"150px"},{default:t(()=>[o(_,{class:"upload-demo",drag:"",action:`${e.baseURL}/adminServer/video/videoAdd`,"auto-upload":!1,"on-change":r.fileChange,limit:1,ref:"videoForm","on-success":r.video_upload_success,"with-credentials":!0},{default:t(()=>[l("i",P,[o(p,{class:"el-icon--upload"},{default:t(()=>[o(f)]),_:1})]),R]),_:1},8,["action","on-change","on-success"])]),_:1}),o(s,{label:"\u5C01\u9762\u56FE\u4E0A\u4F20\uFF1A","label-width":"150px"},{default:t(()=>[o(_,{class:"avatar-uploader",action:`${e.baseURL}/adminServer/video/videoCover`,"show-file-list":!1,"on-change":r.videoCoverChange,"on-success":r.videoCover_upload_success,"auto-upload":!1,ref:"imgForm","with-credentials":!0},{default:t(()=>[d.imageUrl?(m(),u("div",{key:0,class:"avatar",style:C({backgroundImage:`url(${d.imageUrl})`})},null,4)):(m(),u("i",I,[o(p,null,{default:t(()=>[o(g)]),_:1})]))]),_:1},8,["action","on-change","on-success"])]),_:1}),o(s,{"label-width":"150px"},{default:t(()=>[o(b,{type:"success",onClick:r.submitVideo,style:{width:"200px",height:"100px"}},{default:t(()=>[L]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])])])}var Q=A(U,[["render",z],["__scopeId","data-v-313ba785"]]);export{Q as default};
//# sourceMappingURL=VideoAdd.067f4a62.js.map
