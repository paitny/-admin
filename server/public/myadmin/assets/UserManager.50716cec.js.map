{"version":3,"file":"UserManager.50716cec.js","sources":["../../src/views/UserManager.vue"],"sourcesContent":["<template>\r\n  <div id=\"ContactMsg\">\r\n    <el-table\r\n        :data=\"userData\"\r\n        border\r\n        style=\"width: 100%\"\r\n\r\n    >\r\n      <el-table-column\r\n          prop=\"date\"\r\n          label=\"注册日期\"\r\n          :key=\"userData.date\"\r\n          :formatter=\"dateFormat\"\r\n          width=\"200px\"\r\n          align=\"center\"\r\n      >\r\n\r\n      </el-table-column>\r\n      <el-table-column\r\n          prop=\"_id\"\r\n          label=\"id\"\r\n          align=\"center\"\r\n      >\r\n\r\n      </el-table-column>\r\n      <el-table-column\r\n          prop=\"user\"\r\n          label=\"Name\"\r\n          align=\"center\"\r\n      >\r\n\r\n      </el-table-column>\r\n\r\n      <el-table-column\r\n          prop=\"secret\"\r\n          label=\"secret\"\r\n          align=\"center\"\r\n      >\r\n      </el-table-column>\r\n      <el-table-column\r\n          prop=\"photo\"\r\n          label=\"头像\"\r\n          align=\"center\"\r\n      >\r\n        <template #default=\"scope\">\r\n          <div class=\"demo-image__preview\" >\r\n            <el-image\r\n                style=\"width: 150px; height:100px\"\r\n                :src=\"`${baseURL}${scope.row.photo}`\"\r\n                :preview-src-list=\"[`${baseURL}${scope.row.photo}`]\"\r\n                :initial-index=\"4\"\r\n                fit=\"cover\"\r\n                preview-teleported=\"true\"\r\n            >\r\n            </el-image>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n          label=\"管理员账号授权\"\r\n          align=\"center\"\r\n      >\r\n        <template #default=\"scope\">\r\n          <el-switch\r\n              style=\"display: block\"\r\n              v-model=\"scope.row.admin\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n              active-text=\"管理员\"\r\n              inactive-text=\"不是管理员\"\r\n              @change=\"switchHandle(scope.row)\"\r\n          >\r\n          </el-switch>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n          fixed=\"right\"\r\n          label=\"谨慎操作\"\r\n          align=\"center\"\r\n      >\r\n        <template #default=\"scope\">\r\n          <el-button\r\n              type=\"danger\"\r\n              @click=\"deleteUser(scope.row._id)\"\r\n              size=\"large\"\r\n          >注销用户\r\n          </el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: \"ContactMsg\",\r\n  data() {\r\n    return {\r\n      userData: [],\r\n    }\r\n  },\r\n  methods: {\r\n    //转换日期显示\r\n    //ui中自带的方法\r\n    dateFormat: function (row, column) {\r\n      let date = row[column.property];\r\n      if (date == undefined) {\r\n        return \"\";\r\n      }\r\n      return moment(date).format(\"YYYY-MM-DD HH:mm:ss\");\r\n    },\r\n    //请求所有数据\r\n    async getUserData() {\r\n      let {data} = await this.$axios({\r\n        method: \"GET\",\r\n        url: \"/get/user\"\r\n      })\r\n      console.log(data.data)\r\n      if (data.code) {\r\n        return this.$message.error(data.msg)\r\n      }\r\n      this.userData = data.data\r\n\r\n    },\r\n    //用户注销\r\n    async deleteUser(id) {\r\n      let {data} = await this.$axios({\r\n        method: \"DELETE\",\r\n        url: \"/adminServer/consumer/delete\",\r\n        data: {id}\r\n      })\r\n\r\n      if (data.code) {\r\n        return this.$message.error(data.msg)\r\n      }\r\n      this.$message.success(\"用户已注销\")\r\n      await this.getContactData()\r\n    },\r\n    //管理员\r\n    //switch切换触发\r\n    async switchHandle(item) {\r\n      let {data} = await this.$axios({\r\n        method: \"POST\",\r\n        url: \"/adminServer/consumer/admin\",\r\n        data: {\r\n          id: item._id,\r\n          admin: item.admin\r\n        }\r\n      })\r\n      console.log(item.admin)\r\n      if (data.code) {\r\n        return this.$message.error(data.msg)\r\n      }\r\n      await this.getUserData()\r\n    }\r\n  },\r\n  created() {\r\n    this.getUserData()\r\n\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"names":["moment","_openBlock","_createElementBlock","_createVNode","_createBlock","_withCtx","_createElementVNode"],"mappings":"26BAgGA,KAAK,GAAU,CACb,KAAM,aACN,MAAO,CACL,MAAO,CACL,SAAU,CAAE,CACd,CACD,EACD,QAAS,CAGP,WAAY,SAAU,EAAK,EAAQ,CACjC,GAAI,GAAO,EAAI,EAAO,UACtB,MAAI,IAAQ,KACH,GAEFA,EAAO,CAAI,EAAE,OAAO,qBAAqB,CACjD,EAED,KAAM,cAAc,CAClB,GAAI,CAAC,QAAQ,KAAM,MAAK,OAAO,CAC7B,OAAQ,MACR,IAAK,YACN,EAED,GADA,QAAQ,IAAI,EAAK,IAAI,EACjB,EAAK,KACP,MAAO,MAAK,SAAS,MAAM,EAAK,GAAG,EAErC,KAAK,SAAW,EAAK,IAEtB,EAED,KAAM,YAAW,EAAI,CACnB,GAAI,CAAC,QAAQ,KAAM,MAAK,OAAO,CAC7B,OAAQ,SACR,IAAK,+BACL,KAAM,CAAC,IAAE,EACV,EAED,GAAI,EAAK,KACP,MAAO,MAAK,SAAS,MAAM,EAAK,GAAG,EAErC,KAAK,SAAS,QAAQ,gCAAO,EAC7B,KAAM,MAAK,eAAe,CAC3B,EAGD,KAAM,cAAa,EAAM,CACvB,GAAI,CAAC,QAAQ,KAAM,MAAK,OAAO,CAC7B,OAAQ,OACR,IAAK,8BACL,KAAM,CACJ,GAAI,EAAK,IACT,MAAO,EAAK,KACd,EACD,EAED,GADA,QAAQ,IAAI,EAAK,KAAK,EAClB,EAAK,KACP,MAAO,MAAK,SAAS,MAAM,EAAK,GAAG,EAErC,KAAM,MAAK,YAAY,CACzB,CACD,EACD,SAAU,CACR,KAAK,YAAY,CAEnB,CACF,EAjKO,EAAA,CAAA,GAAG,YAAY,EA4CP,EAAA,CAAA,MAAM,qBAAqB,MAwC/B,2BACD,yHArFR,MAAAC,GAAA,EAAAC,EAyFM,MAzFN,EAyFM,CAxFJC,EAuFW,EAAA,CAtFN,KAAM,EAAQ,SACf,OAAA,GACA,MAAA,CAAmB,MAAA,MAAA,cAGrB,IASkB,MATlBC,EASkB,EAAA,CARd,KAAK,OACL,MAAM,2BACL,IAAK,EAAQ,SAAC,KACd,UAAW,EAAU,WACtB,MAAM,QACN,MAAM,iCAIVD,EAMkB,EAAA,CALd,KAAK,MACL,MAAM,KACN,MAAM,WAIVA,EAMkB,EAAA,CALd,KAAK,OACL,MAAM,OACN,MAAM,WAKVA,EAKkB,EAAA,CAJd,KAAK,SACL,MAAM,SACN,MAAM,WAGVA,EAkBkB,EAAA,CAjBd,KAAK,QACL,MAAM,eACN,MAAM,WAEG,QAAOE,EAChB,AAUM,GAXiB,CACvBC,EAUM,MAVN,EAUM,CATJH,EAQW,EAAA,CAPP,MAAA,CAAkC,MAAA,QAAA,OAAA,OAAA,EACjC,OAAQ,EAAO,UAAG,EAAM,IAAI,QAC5B,uBAAsB,EAAO,UAAG,EAAM,IAAI,OAAK,EAC/C,gBAAe,EAChB,IAAI,QACJ,qBAAmB,qDAM7BA,EAgBkB,EAAA,CAfd,MAAM,6CACN,MAAM,WAEG,QAAOE,EAChB,AASY,GAVW,CACvBF,EASY,EAAA,CARR,MAAA,CAAsB,QAAA,OAAA,aACb,EAAM,IAAI,+BAAV,EAAM,IAAI,MAAK,EACxB,eAAa,UACb,iBAAe,UACf,cAAY,qBACZ,gBAAc,iCACb,SAAQ,GAAA,EAAA,aAAa,EAAM,GAAG,mEAKvCA,EAakB,EAAA,CAZd,MAAM,QACN,MAAM,2BACN,MAAM,WAEG,QAAOE,EAChB,AAKY,GANW,CACvBF,EAKY,EAAA,CAJR,KAAK,SACJ,WAAO,EAAU,WAAC,EAAM,IAAI,GAAG,EAChC,KAAK,oBACR,IACD"}