{"version":3,"file":"SwiperManager.d4bdb041.js","sources":["../../src/components/Swiper.vue","../../src/views/SwiperManage/SwiperManager.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-carousel :height=\"bannerHeight+'px'\" type=\"card\">\r\n      <el-carousel-item v-for=\"item in urlList\" :key=\"item.id\">\r\n        <div class=\"img\" :style=\"{backgroundImage: `url(${baseURL}${item.swiper})`}\" alt=\"正在加载中\" >  </div>\r\n      </el-carousel-item>\r\n    </el-carousel>\r\n  </div>\r\n\r\n</template>\r\n<script>\r\nexport default {\r\n  name: 'swiper',\r\n  data(){\r\n    return {\r\n      urlList: [\r\n        {id:0},\r\n        {id:1},\r\n        {id:2},\r\n        {id:3},\r\n        {id:4},\r\n      ]\r\n      ,\r\n      //el-carousel容器高度\r\n      bannerHeight:0,\r\n      screenWidth:0\r\n    };\r\n  },\r\n  methods: {\r\n   async getSwiper(){\r\n      let {data}=await this.$axios({\r\n        method:\"GET\",\r\n        url:\"/get/swiper\"\r\n      })\r\n     if(data.code){\r\n       return this.$message.error(data.msg)\r\n     }\r\n       this.urlList=data.data\r\n\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getSwiper()\r\n    // 首次加载时,初始化高度\r\n    this.screenWidth = window.innerWidth\r\n    this.bannerHeight =350 / 2200 * this.screenWidth\r\n    // 窗口大小发生改变\r\n    window.onresize = () => {\r\n      this.screenWidth = window.innerWidth\r\n      this.bannerHeight = 350 / 2200 * this.screenWidth\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.el-carousel__item h3 {\r\n  color: #475669;\r\n  font-size: 14px;\r\n  opacity: 0.75;\r\n  line-height: 200px;\r\n  margin:0;\r\n\r\n\r\n}\r\n:deep(.el-carousel__indicators) {// 指示器\r\n  left: unset;\r\n  transform: unset;\r\n  right: 2%;\r\n}\r\n:deep(.el-carousel__button) {// 指示器按钮\r\n  width: 8px;\r\n  height: 8px;\r\n  border: none;\r\n  border-radius: 50%;\r\n  background-color: #00b7ff;\r\n}\r\n.el-carousel__item:nth-child(2n) {\r\n  background-color: #99a9bf;\r\n  border-radius: 10px;\r\n}\r\n\r\n.el-carousel__item:nth-child(2n+1) {\r\n  background-color: #d3dce6;\r\n  border-radius: 10px;\r\n}\r\n.img{\r\n  width: 100%;\r\n  height: inherit;\r\n  border-radius: 10px;\r\n  background-size:cover ;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"swiperExhibition\">\r\n    <Swiper></Swiper>\r\n  </div>\r\n\r\n  <el-table\r\n      :data=\"MangerSwiper\"\r\n      border\r\n      style=\"width: 100%;height: 100%\"\r\n  >\r\n    <el-table-column\r\n        prop=\"date\"\r\n        label=\"发布日期\"\r\n        :key=\"MangerSwiper.date\"\r\n        :formatter=\"dateFormat\"\r\n        align=\"center\"\r\n    >\r\n\r\n    </el-table-column>\r\n    <el-table-column label=\"重新上传轮播图\"\r\n                     width=\"1000\"\r\n                     align=\"center\"\r\n    >\r\n      <template #default=\"scope\">\r\n        <div class=\"swiper\">\r\n          <el-image\r\n              style=\"width: 450px; height: 250px\"\r\n              :src=\"`${baseURL}${scope.row.swiper}`\"\r\n              :preview-src-list=\"[`${baseURL}${scope.row.swiper}`]\"\r\n              preview-teleported=\"true\"\r\n          >\r\n          </el-image>\r\n          <el-upload\r\n              class=\"upload-demo\"\r\n              drag\r\n              :action=\"`${baseURL}/adminServer/swiper/swiperAdd`\"\r\n              :on-change=\"swiper_before_upload\"\r\n              :limit=\"1\"\r\n              ref=\"swiperForm\"\r\n              :on-success=\"function(res){swiper_upload_success(res,scope.row._id)}\"\r\n              :with-credentials=\"true\"\r\n          >\r\n            <i class=\"el-icon-upload\">\r\n              <el-icon class=\"el-icon--upload\">\r\n                <upload-filled/>\r\n              </el-icon>\r\n            </i>\r\n            <div class=\"el-upload__text\">将.jpj或者png文件拖到此处，或<em>点击上传</em></div>\r\n\r\n          </el-upload>\r\n        </div>\r\n\r\n      </template>\r\n    </el-table-column>\r\n\r\n    <el-table-column\r\n        fixed=\"right\"\r\n        label=\"操作\"\r\n        align=\"center\"\r\n    >\r\n      <template #default=\"scope\">\r\n        <el-button\r\n            style=\"width: 200px;height: 100px;margin: 0 auto\"\r\n            type=\"danger\"\r\n            @click=\"deleteSwiper(scope.row._id)\"\r\n            size=\"large\"\r\n        >删除\r\n        </el-button>\r\n      </template>\r\n    </el-table-column>\r\n  </el-table>\r\n</template>\r\n\r\n<script>\r\nimport moment from \"moment\";\r\nimport Swiper from \"../../components/Swiper.vue\";\r\nexport default {\r\n  name: \"SwiperManger\",\r\n  data() {\r\n    return {\r\n      MangerSwiper: []\r\n    }\r\n  },\r\n  components:{\r\n    Swiper\r\n  },\r\n  methods: {\r\n    //上传时间\r\n    dateFormat: function (row, column) {\r\n      let date = row[column.property];\r\n      if (date == undefined) {\r\n        return \"\";\r\n      }\r\n\r\n      return moment(date).format(\"YYYY-MM-DD HH:mm:ss\");\r\n    },\r\n    //获取轮播图数据\r\n    async getMangerSwiper() {\r\n      let {data} = await this.$axios({\r\n        method: \"GET\",\r\n        url: \"/get/swiper\"\r\n      })\r\n      this.MangerSwiper = data.data\r\n    },\r\n    async swiperUpdate(id, doc) {\r\n      let {data} = await this.$axios({\r\n        method: \"POST\",\r\n        url: \"/adminServer/swiper/update\",\r\n        data: {id, doc}\r\n      })\r\n      if (data.code) {\r\n        return this.$message.error(data.msg)\r\n      }\r\n      this.$message.success(\"更新成功\")\r\n      await this.getMangerSwiper()\r\n    }\r\n    ,\r\n    //上传之前钩子\r\n    swiper_before_upload(file, fileList) {\r\n      if (/^(\\s|\\S)+(jpg|png|JPG|PNG)+$/.test(file.name)) {\r\n      } else {\r\n        this.$message.error(\"只能上传.png 或. jpj文件\")\r\n        fileList.pop()\r\n      }\r\n    },\r\n    //轮播图上传成功钩子\r\n    swiper_upload_success(res, id) {\r\n      if (res.code) {\r\n        return this.$message.error(res.msg)\r\n      }\r\n      this.swiperUpdate(id, {swiper: res.url})\r\n    }\r\n    ,\r\n    //删除轮播图\r\n    async deleteSwiper(id) {\r\n      let {data} = await this.$axios({\r\n        method: \"POST\",\r\n        url: \"/adminServer/swiper/delete\",\r\n        data: {id}\r\n      })\r\n      if (data.code) {\r\n        return this.$message.error(data.msg)\r\n      }\r\n      this.$message.success(\"删除成功\")\r\n      await this.getMangerSwiper()\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.getMangerSwiper()\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.swiperExhibition{\r\n  width: 60%;\r\n  margin: 0 auto;\r\n}\r\n.swiper {\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n  :deep(.el-upload-dragger) {\r\n    width: 360px;\r\n\r\n  }\r\n}\r\n</style>\r\n"],"names":["_sfc_main","_createElementBlock","_createVNode","_Fragment","_renderList","_createBlock","_createElementVNode","_normalizeStyle","moment","_withCtx"],"mappings":"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"}