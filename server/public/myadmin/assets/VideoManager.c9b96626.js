import{h as y}from"./moment.17f8281e.js";import{_ as V,r as l,o as v,j as f,w as i,b as a,a as u,g as _}from"./index.0d4a0c51.js";const $={name:"VideoManger",data(){return{MangerVideo:[]}},methods:{dateFormat:function(e,t){let s=e[t.property];return s==null?"":y(s).format("YYYY-MM-DD HH:mm:ss")},async getVideo(){let{data:e}=await this.$axios({method:"get",url:"/get/video"});if(e.code)return this.$message.error(e.msg);this.MangerVideo=e.data},async update(e,t){let{data:s}=await this.$axios({method:"POST",url:"/adminServer/video/update",data:{id:e,doc:t}});if(s.code)return this.$message.error(s.msg);this.$message.success("\u66F4\u65B0\u6210\u529F"),await this.getVideo()},video_before_upload(e){let t=/(.*)\.(mp4|rmvb|avi|ts|flv|mov|3gb)$/.test(e.name);return t||this.$message.error("\u8BF7\u4E0A\u4F20\u89C6\u9891\u6587\u4EF6"),t},video_upload_success(e,t){if(e.code)return this.$message.error(e.msg);this.update(t,{video:e.url})},videoCover_before_upload(e){const t=/^image\/(jpeg|png)$/.test(e.type),s=e.size/1024/1024<2;return t||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u53EA\u80FD\u662F JPG/PNG \u683C\u5F0F!"),s||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),t&&s},videoCover_upload_success(e,t){if(e.code)return this.$message.error(e.msg);this.update(t,{videoCover:e.url})},async deleteVideo(e){let{data:t}=await this.$axios({method:"DELETE",url:"/adminServer/video/delete",data:{id:e}});if(t.code)return this.$message.error(t.msg);this.$message.success("\u89C6\u9891\u5DF2\u5220\u9664\u5B8C\u6210"),await this.getVideo()}},created(){this.getVideo()}},C={style:{"margin-top":"10px"}},x=_("\u66F4\u65B0\u89C6\u9891"),M={class:"videoCover"},k=_("\u91CD\u4F20\u5C01\u9762"),L={style:{"margin-bottom":"50px"}},P=_("\u4FEE\u6539 "),U=_("\u5220\u9664 ");function R(e,t,s,z,p,d){const n=l("el-table-column"),g=l("el-input"),h=l("vue3VideoPlay"),c=l("el-button"),m=l("el-upload"),w=l("el-image"),b=l("el-table");return v(),f(b,{data:p.MangerVideo,border:"",style:{width:"100%",height:"100%"}},{default:i(()=>[(v(),f(n,{prop:"date",label:"\u53D1\u5E03\u65E5\u671F",key:p.MangerVideo.date,formatter:d.dateFormat,align:"center"},null,8,["formatter"])),a(n,{label:"\u6807\u9898"},{default:i(o=>[a(g,{modelValue:o.row.title,"onUpdate:modelValue":r=>o.row.title=r},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(n,{label:"\u91CD\u65B0\u4E0A\u4F20\u89C6\u9891",align:"center",width:"500px"},{default:i(o=>[u("div",null,[a(h,{poster:`${e.baseURL}${o.row.videoCover}`,src:`${e.baseURL}${o.row.video}`,type:"video/mp4",autoPlay:!1},null,8,["poster","src"])]),a(m,{class:"upload-demo",action:`${e.baseURL}/adminServer/video/videoAdd`,"on-success":function(r){d.video_upload_success(r,o.row._id)},"before-upload":d.video_before_upload,limit:1,"with-credentials":!0,"show-file-list":!1},{default:i(()=>[u("div",C,[a(c,{size:"large",type:"success"},{default:i(()=>[x]),_:1})])]),_:2},1032,["action","on-success","before-upload"])]),_:1}),a(n,{label:"\u91CD\u65B0\u4E0A\u4F20\u5C01\u9762\u56FE"},{default:i(o=>[u("div",M,[a(w,{style:{width:"150px",height:"100px"},src:`${e.baseURL}${o.row.videoCover}`,"preview-src-list":[`${e.baseURL}${o.row.videoCover}`],"preview-teleported":"true"},null,8,["src","preview-src-list"]),a(m,{class:"upload-demo",action:`${e.baseURL}/adminServer/video/videoCover`,"on-success":function(r){d.videoCover_upload_success(r,o.row._id)},"before-upload":d.videoCover_before_upload,limit:1,"with-credentials":!0,"show-file-list":!1},{default:i(()=>[a(c,{size:"large",type:"warning"},{default:i(()=>[k]),_:1})]),_:2},1032,["action","on-success","before-upload"])])]),_:1}),a(n,{fixed:"right",label:"\u64CD\u4F5C",width:"150px",align:"center"},{default:i(o=>[u("div",L,[a(c,{type:"primary",onClick:r=>d.update(o.row._id,{title:o.row.title}),size:"large"},{default:i(()=>[P]),_:2},1032,["onClick"])]),u("div",null,[a(c,{type:"danger",onClick:r=>d.deleteVideo(o.row._id),size:"large"},{default:i(()=>[U]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])}var B=V($,[["render",R],["__scopeId","data-v-83d4eec0"]]);export{B as default};
