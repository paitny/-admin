import{resolveComponent as r,openBlock as u,createElementBlock as p,Fragment as y,createElementVNode as s,createVNode as t,withCtx as o,normalizeStyle as U,pushScopeId as k,popScopeId as V,createTextVNode as v}from"https://esm.sh/vue@3.0.5";import{_ as C}from"./index.10c0c1b8.js";import"https://cdn.jsdelivr.net/npm/ant-design-vue@2.2.0-beta.6/lib/grid/style/index.css";import"https://esm.sh/axios@0.21.1";import"https://esm.sh/vuex@4.0.2";import"https://esm.sh/dayjs@1.10.5";import"https://esm.sh/dayjs@1.10.5/plugin/localeData.js";import"https://esm.sh/dayjs@1.10.5/plugin/customParseFormat.js";import"https://esm.sh/dayjs@1.10.5/plugin/advancedFormat.js";import"https://esm.sh/dayjs@1.10.5/plugin/weekOfYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/weekYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/dayOfYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/isSameOrAfter.js";import"https://esm.sh/dayjs@1.10.5/plugin/isSameOrBefore.js";const F={name:"ArticleAdd",data(){return{form:{title:"",des:"",md:"",cover:""},imageUrl:""}},methods:{submitForm(){this.$refs.mdForm.submit()},async submit(){let{data:e}=await this.$axios({method:"POST",url:"/adminServer/article/add",data:this.form});if(e.code)return this.$message.error(e.msg);await this.$router.push("/articleManager")},fileChange(e,l){if(e.status==="ready")if(/^(.+)\.md$/.test(e.name)){if(this.form.title)return;this.form.title=RegExp.$1}else this.$message.error("\u53EA\u80FD\u4E0A\u4F20 .md \u6587\u4EF6"),l.pop()},beforeRemove(){this.form.title=""},md_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20md\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.md=e.url,this.imageUrl?this.$refs.imgForm.submit():this.submit()},coverChange(e,l){if(e.status!=="ready")return;const n=/^image\/(jpeg|png)$/.test(e.raw.type),c=e.raw.size/1024/1024<2;n||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u53EA\u80FD\u662F JPG/PNG \u683C\u5F0F!"),c||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),n&&c?this.imageUrl=URL.createObjectURL(e.raw):(this.imageUrl="",l.pop())},cover_upload_success(e){if(e.code)return this.$message.error("\u4E0A\u4F20\u5C01\u9762\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u540E\u7AEF\u62A5\u9519");this.form.cover=e.url,this.submit()}}},S=e=>(k("data-v-55877708"),e=e(),V(),e),R={id:"ArticleAdd"},$={class:"el-icon-upload"},P=S(()=>s("div",{class:"el-upload__text"},[v("\u5C06.md\u6587\u4EF6\u62D6\u5230\u6B64\u5904\uFF0C\u6216"),s("em",null,"\u70B9\u51FB\u4E0A\u4F20")],-1)),z={key:1,class:"el-icon-plus avatar-uploader-icon"},I=v("\u786E\u8BA4\u53D1\u8868");function L(e,l,n,c,a,i){const _=r("el-input"),d=r("el-form-item"),g=r("upload-filled"),f=r("el-icon"),h=r("el-upload"),b=r("Plus"),x=r("el-button"),w=r("el-form"),A=r("router-view");return u(),p(y,null,[s("div",R,[t(w,{model:a.form,"status-icon":"",ref:"ruleForm","label-width":"100px"},{default:o(()=>[t(d,{label:"\u6807\u9898\uFF1A","label-width":"100px"},{default:o(()=>[t(_,{modelValue:a.form.title,"onUpdate:modelValue":l[0]||(l[0]=m=>a.form.title=m),placeholder:"\u53EF\u901A\u8FC7\u4E0A\u4F20 md \u81EA\u52A8\u83B7\u53D6\u6587\u4EF6\u540D"},null,8,["modelValue"])]),_:1}),t(d,{label:"\u63CF\u8FF0\uFF1A","label-width":"100px"},{default:o(()=>[t(_,{type:"textarea",modelValue:a.form.des,"onUpdate:modelValue":l[1]||(l[1]=m=>a.form.des=m)},null,8,["modelValue"])]),_:1}),t(d,{label:"md\u4E0A\u4F20\uFF1A","label-width":"100px"},{default:o(()=>[t(h,{class:"upload-demo",drag:"",action:`${e.baseURL}/adminServer/article/md`,"auto-upload":!1,"on-change":i.fileChange,"on-success":i.md_upload_success,"before-remove":i.beforeRemove,limit:1,ref:"mdForm","with-credentials":!0},{default:o(()=>[s("i",$,[t(f,{class:"el-icon--upload"},{default:o(()=>[t(g)]),_:1})]),P]),_:1},8,["action","on-change","on-success","before-remove"])]),_:1}),t(d,{label:"\u5C01\u9762\u56FE\u4E0A\u4F20\uFF1A","label-width":"100px"},{default:o(()=>[t(h,{class:"avatar-uploader",action:`${e.baseURL}/adminServer/article/cover`,"show-file-list":!1,"on-change":i.coverChange,"on-success":i.cover_upload_success,"auto-upload":!1,ref:"imgForm","with-credentials":!0},{default:o(()=>[a.imageUrl?(u(),p("div",{key:0,class:"avatar",style:U({backgroundImage:`url(${a.imageUrl})`})},null,4)):(u(),p("i",z,[t(f,null,{default:o(()=>[t(b)]),_:1})]))]),_:1},8,["action","on-change","on-success"])]),_:1}),t(d,{"label-width":"100px"},{default:o(()=>[t(x,{type:"primary",onClick:i.submitForm,size:"large"},{default:o(()=>[I]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),t(A)],64)}var W=C(F,[["render",L],["__scopeId","data-v-55877708"]]);export{W as default};
//# sourceMappingURL=ArticleAdd.c0092acb.js.map
