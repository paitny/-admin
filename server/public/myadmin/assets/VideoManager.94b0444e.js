import{h as y}from"./moment.17f8281e.js";import{resolveComponent as l,openBlock as v,createBlock as f,withCtx as i,createVNode as a,createElementVNode as u,createTextVNode as m}from"https://esm.sh/vue@3.0.5";import{_ as V}from"./index.10c0c1b8.js";import"https://cdn.jsdelivr.net/npm/ant-design-vue@2.2.0-beta.6/lib/grid/style/index.css";import"https://esm.sh/axios@0.21.1";import"https://esm.sh/vuex@4.0.2";import"https://esm.sh/dayjs@1.10.5";import"https://esm.sh/dayjs@1.10.5/plugin/localeData.js";import"https://esm.sh/dayjs@1.10.5/plugin/customParseFormat.js";import"https://esm.sh/dayjs@1.10.5/plugin/advancedFormat.js";import"https://esm.sh/dayjs@1.10.5/plugin/weekOfYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/weekYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/dayOfYear.js";import"https://esm.sh/dayjs@1.10.5/plugin/isSameOrAfter.js";import"https://esm.sh/dayjs@1.10.5/plugin/isSameOrBefore.js";const $={name:"VideoManger",data(){return{MangerVideo:[]}},methods:{dateFormat:function(e,t){let r=e[t.property];return r==null?"":y(r).format("YYYY-MM-DD HH:mm:ss")},async getVideo(){let{data:e}=await this.$axios({method:"get",url:"/get/video"});if(e.code)return this.$message.error(e.msg);this.MangerVideo=e.data},async update(e,t){let{data:r}=await this.$axios({method:"POST",url:"/adminServer/video/update",data:{id:e,doc:t}});if(r.code)return this.$message.error(r.msg);this.$message.success("\u66F4\u65B0\u6210\u529F"),await this.getVideo()},video_before_upload(e){let t=/(.*)\.(mp4|rmvb|avi|ts|flv|mov|3gb)$/.test(e.name);return t||this.$message.error("\u8BF7\u4E0A\u4F20\u89C6\u9891\u6587\u4EF6"),t},video_upload_success(e,t){if(e.code)return this.$message.error(e.msg);this.update(t,{video:e.url})},videoCover_before_upload(e){const t=/^image\/(jpeg|png)$/.test(e.type),r=e.size/1024/1024<2;return t||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u53EA\u80FD\u662F JPG/PNG \u683C\u5F0F!"),r||this.$message.error("\u4E0A\u4F20\u5934\u50CF\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 2MB!"),t&&r},videoCover_upload_success(e,t){if(e.code)return this.$message.error(e.msg);this.update(t,{videoCover:e.url})},async deleteVideo(e){let{data:t}=await this.$axios({method:"DELETE",url:"/adminServer/video/delete",data:{id:e}});if(t.code)return this.$message.error(t.msg);this.$message.success("\u89C6\u9891\u5DF2\u5220\u9664\u5B8C\u6210"),await this.getVideo()}},created(){this.getVideo()}},C={style:{"margin-top":"10px"}},x=m("\u66F4\u65B0\u89C6\u9891"),M={class:"videoCover"},k=m("\u91CD\u4F20\u5C01\u9762"),L={style:{"margin-bottom":"50px"}},P=m("\u4FEE\u6539 "),U=m("\u5220\u9664 ");function R(e,t,r,z,p,d){const n=l("el-table-column"),h=l("el-input"),g=l("vue3VideoPlay"),c=l("el-button"),_=l("el-upload"),w=l("el-image"),b=l("el-table");return v(),f(b,{data:p.MangerVideo,border:"",style:{width:"100%",height:"100%"}},{default:i(()=>[(v(),f(n,{prop:"date",label:"\u53D1\u5E03\u65E5\u671F",key:p.MangerVideo.date,formatter:d.dateFormat,align:"center"},null,8,["formatter"])),a(n,{label:"\u6807\u9898"},{default:i(o=>[a(h,{modelValue:o.row.title,"onUpdate:modelValue":s=>o.row.title=s},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(n,{label:"\u91CD\u65B0\u4E0A\u4F20\u89C6\u9891",align:"center",width:"500px"},{default:i(o=>[u("div",null,[a(g,{poster:`${e.baseURL}${o.row.videoCover}`,src:`${e.baseURL}${o.row.video}`,type:"video/mp4",autoPlay:!1},null,8,["poster","src"])]),a(_,{class:"upload-demo",action:`${e.baseURL}/adminServer/video/videoAdd`,"on-success":function(s){d.video_upload_success(s,o.row._id)},"before-upload":d.video_before_upload,limit:1,"with-credentials":!0,"show-file-list":!1},{default:i(()=>[u("div",C,[a(c,{size:"large",type:"success"},{default:i(()=>[x]),_:1})])]),_:2},1032,["action","on-success","before-upload"])]),_:1}),a(n,{label:"\u91CD\u65B0\u4E0A\u4F20\u5C01\u9762\u56FE"},{default:i(o=>[u("div",M,[a(w,{style:{width:"150px",height:"100px"},src:`${e.baseURL}${o.row.videoCover}`,"preview-src-list":[`${e.baseURL}${o.row.videoCover}`],"preview-teleported":"true"},null,8,["src","preview-src-list"]),a(_,{class:"upload-demo",action:`${e.baseURL}/adminServer/video/videoCover`,"on-success":function(s){d.videoCover_upload_success(s,o.row._id)},"before-upload":d.videoCover_before_upload,limit:1,"with-credentials":!0,"show-file-list":!1},{default:i(()=>[a(c,{size:"large",type:"warning"},{default:i(()=>[k]),_:1})]),_:2},1032,["action","on-success","before-upload"])])]),_:1}),a(n,{fixed:"right",label:"\u64CD\u4F5C",width:"150px",align:"center"},{default:i(o=>[u("div",L,[a(c,{type:"primary",onClick:s=>d.update(o.row._id,{title:o.row.title}),size:"large"},{default:i(()=>[P]),_:2},1032,["onClick"])]),u("div",null,[a(c,{type:"danger",onClick:s=>d.deleteVideo(o.row._id),size:"large"},{default:i(()=>[U]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])}var W=V($,[["render",R],["__scopeId","data-v-83d4eec0"]]);export{W as default};
//# sourceMappingURL=VideoManager.94b0444e.js.map
